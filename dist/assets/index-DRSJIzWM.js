(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();async function m(n,t){try{const e=await fetch(n,{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Bad response: ${e.status}`);return await e.json()}catch(e){return console.warn("Fetch failed, using fallback for:",n,e.message),t}}async function g(){const t=await m("https://bible-api.com/data/web/random",{random_verse:{book:"John",chapter:3,verse:16,text:"For God so loved the world that he gave his one and only Son..."},translation:{name:"World English Bible"}});if(t&&t.random_verse){const e=t.random_verse,o=t.translation?.name||"Unknown";return{reference:`${e.book} ${e.chapter}:${e.verse}`,translation:o,text:e.text.trim()}}return{reference:"John 3:16",translation:"Unknown",text:"Scripture unavailable."}}async function h(){const t=await m("https://random-quotes-freeapi.vercel.app/api/random",{quote:"Be a light. Keep going.",author:"Unknown"});return{text:t.quote??"Be a light. Keep going.",author:t.author??"Unknown"}}function v(n,t){n.innerHTML=`
    <p class="verse-text">“${t.text}”</p>
    <p class="verse-meta">${t.reference} — <span>${t.translation}</span></p>
  `,n.classList.remove("loading")}function E(n,t){n.innerHTML=`
    <p class="quote-text">“${t.text}”</p>
    <p class="quote-meta">— ${t.author}</p>
  `,n.classList.remove("loading")}const f="vv-journal";function c(){try{return JSON.parse(localStorage.getItem(f))??[]}catch{return[]}}function l(n){localStorage.setItem(f,JSON.stringify(n))}function w(){return c().sort((n,t)=>t.createdAt-n.createdAt)}function b({title:n,body:t,tags:e}){const o={id:crypto.randomUUID(),title:n.trim(),body:t.trim(),tags:e.split(",").map(a=>a.trim()).filter(Boolean),createdAt:Date.now(),updatedAt:Date.now()},r=c();return r.push(o),l(r),o}function L(n,t){const e=c(),o=e.findIndex(r=>r.id===n);return o===-1?null:(e[o]={...e[o],...t,updatedAt:Date.now()},l(e),e[o])}function I(n){l(c().filter(t=>t.id!==n))}function d(n){return new Date(n).toLocaleString()}function i(n){const t=w();if(!t.length){n.innerHTML='<p class="muted">No entries yet. Write your first reflection on the Home page.</p>';return}n.innerHTML=t.map(e=>`
    <div class="entry" data-id="${e.id}">
      <h3>${e.title||"(untitled)"}</h3>
      <p class="meta">Created: ${d(e.createdAt)} • Updated: ${d(e.updatedAt)}</p>
      ${e.tags?.length?`<p class="meta">Tags: ${e.tags.join(", ")}</p>`:""}
      <p>${e.body.replace(/\n/g,"<br/>")}</p>
      <div class="controls">
        <button data-edit>Edit</button>
        <button data-delete>Delete</button>
      </div>
    </div>
  `).join(""),n.querySelectorAll("[data-delete]").forEach(e=>{e.addEventListener("click",o=>{const r=o.currentTarget.closest(".entry").dataset.id;I(r),i(n)})}),n.querySelectorAll("[data-edit]").forEach(e=>{e.addEventListener("click",o=>{const r=o.currentTarget.closest(".entry"),a=r.dataset.id,s=prompt("New title:",r.querySelector("h3").textContent)??"",y=prompt("New body:",r.querySelector("p:not(.meta)").textContent)??"";L(a,{title:s,body:y}),i(n)})})}const u="vv-dark";function $(n){const t=localStorage.getItem(u)==="1";document.documentElement.classList.toggle("dark",t),n.checked=t,n.addEventListener("change",()=>{const e=n.checked;document.documentElement.classList.toggle("dark",e),localStorage.setItem(u,e?"1":"0")})}function p(){const n=location.hash.replace("#","")||"home";document.querySelectorAll(".view").forEach(e=>e.hidden=!0);const t=document.getElementById(n)||document.getElementById("home");if(t.hidden=!1,t.id==="history"){const e=document.getElementById("entry-list");i(e)}}window.addEventListener("hashchange",p);document.getElementById("year").textContent=new Date().getFullYear();$(document.getElementById("dark-mode-toggle"));(async function(){const t=document.getElementById("daily-verse"),e=document.getElementById("daily-quote"),o=await g(),r=await h();v(t,o),E(e,r)})();document.getElementById("entry-form").addEventListener("submit",n=>{n.preventDefault();const t=document.getElementById("entry-title").value,e=document.getElementById("entry-body").value,o=document.getElementById("entry-tags").value;b({title:t,body:e,tags:o}),n.target.reset(),location.hash="history"});p();
